/**
   _____                 _     _        
  / ____|               | |   | |       
 | |        __ _   ___  | |_  | |   ___ 
 | |       / _` | / __| | __| | |  / _ \
 | |____  | (_| | \__ \ | |_  | | |  __/
  \_____|  \__,_| |___/  \__| |_|  \___|
 ----------------------------------------
 * Castle's Login JavaScript
 * Last Update: 2020/03/23
 * Author: ohmyga (https://ohmyga.cn)
 * GitHub: https://github.com/ohmyga233/castle-Typecho-Theme/
 * LICENSE: GPL V3 (https://www.gnu.org/licenses/gpl-3.0.html)
 **/

/**
 * 创建组件
 */
var CastleLoginCreate = {
 //背景
 BG: function() {
  var bg = document.createElement("div");
  bg.setAttribute("id", "moe-typecho-login-bg");
  document.body.insertBefore(bg, document.body.firstChild);
 },

 //Logo
 TypechoLogo: function() {
  var logo = document.querySelectorAll('.typecho-login-wrap .typecho-login a')[0];
  logo.setAttribute('title', '由 Typecho 强力驱动');
  logo.setAttribute('target', '_black');
 },

 //底部链接
 moreLink: function() {
  var link = document.querySelectorAll('.typecho-login .more-link a'),
      linkTmp = '',
      classStyle = '';
  for(let i=0; i<link.length; ++i) {
   if (link[i].innerText == '用户注册' || link[i].innerText == '用户登录') {
    classStyle = ' class="moe-more-link-reg"';
   }
   linkTmp += '<a href="'+link[i].href+'"'+classStyle+'>'+link[i].innerText+'</a>';
  }

  document.querySelectorAll('.typecho-login .more-link')[0].innerHTML = linkTmp;
 },

 //更换登录按钮及记住按钮的位置
 check2Login: function() {
  if (document.querySelectorAll('.typecho-login form')[0].getAttribute('name') != 'login') { return false; };
  var login = document.querySelectorAll('.typecho-login form p'),
      dataTmp = '',
      loginCount = login.length;
  
  dataTmp += login[loginCount-1].outerHTML;
  dataTmp += login[loginCount-2].outerHTML;
  login[loginCount-1].outerHTML = '';
  login[loginCount-2].outerHTML = '';
  document.querySelectorAll('.typecho-login form')[0].innerHTML += dataTmp;
   
 }
};

window.onload = function() {
 console.clear();

 CastleLoginCreate.BG();
 CastleLoginCreate.TypechoLogo();
 CastleLoginCreate.moreLink();
 CastleLoginCreate.check2Login();
};